var bible={parseReference:function(e){var n,t,o,r,s=-1,i=-1,a=-1,l=-1,c=-1,d=new String(e).replace(/(\d+[\.:])\s+(\d+)/gi,"$1$2"),p=0,u=null;for("ff"==d.slice(-2)&&(d=d.slice(0,-2),p=1),n=(d=d.replace(/(\d)[a|b]/gi,"$1")).length;n>=0;n--)if(/[A-Za-z]/.test(d.substring(n-1,n))){u=d.substring(0,n).toLowerCase();break}if(null!=u){for(n=0,o=bbooks.Books.length;n<o&&-1==s;n++)for(t=0,r=bbooks.Books[n].names.length;t<r;t++)if(name=new String(bbooks.Books[n].names[t]).toLowerCase(),u==name){s=n,d=d.substring(name.length);break}s>-1&&(params=bible.parseScriptureRef(d,s,p),i=params.c1,l=params.c2,a=params.v1,c=params.v2)}return bible.Reference(s,i,a,l,c)},parseScriptureRef:function(e,n,t){var o,r,s=-1,i=-1,a=-1,l=-1,c=!1,d=!1,p=!1,u="";for(o=0;o<e.length;o++)if(" "==(r=e.charAt(o))||isNaN(r)){if(!p)continue;"-"==r?(c=!0,d=!1):":"!=r&&","!=r||(d=!0),u="",p=!1}else p=!0,u+=r,d?c?l=parseInt(u,10):a=parseInt(u,10):c?i=parseInt(u,10):s=parseInt(u,10);return 1==bbooks.Books[n].verses.length&&s>0&&-1==a&&(a=s,s=1),s>0&&a>0&&i>0&&(l<=0||1==t)&&(l=i,i=s),s>0&&a<=0&&i>0&&l>0&&(a=1),n>-1&&s<=0&&a<=0&&i<=0&&l<=0&&(s=1),1==t&&(l=999),void 0!==bbooks.Books[n].verses&&(-1==s?s=1:-1!=a&&s>bbooks.Books[n].verses.length&&(s=bbooks.Books[n].verses.length,a>0&&(a=1)),a>bbooks.Books[n].verses[s-1]&&(a=bbooks.Books[n].verses[s-1])),{c1:s,c2:i,v1:a,v2:l}},Reference:function(){var e=-1,n=-1,t=-1,o=-1,r=-1,s=arguments;if(0==s.length);else{if(1==s.length&&"string"==typeof s[0])return bible.parseReference(s[0]);if(1==s.length)return null;e=s[0],n=s[1],s.length>=3&&(t=s[2]),s.length>=4&&(o=s[3]),s.length>=5&&(r=s[4])}return{bookIndex:e,chapter:n,verse:t,chapter1:n,verse1:t,chapter2:o,verse2:r,isValid:function(){return e>-1&&e<bbooks.Books.length&&n>0&&n<=bbooks.Chapters[e]},chapterAndVerse:function(e,n,t){e=e||":",n=n||"-",t=t||"-";var o=this.chapter1,r=this.chapter2,s=this.verse1,i=this.verse2,a=1==bbooks.Books[this.bookIndex].verses.length?"":o,l=""==a?"":e;return o>0&&s<=0&&r<=0&&i<=0?a:o>0&&s>0&&r<=0&&i<=0?a+l+s:o>0&&s>0&&r<=0&&i>0?a+l+s+(999==i?"ff":n+i):o>0&&s<=0&&r>0&&i<=0?o+t+r:o>0&&s>0&&r>0&&i>0?o+e+s+t+(o!=r?r+e:"")+i:"?"},toString:function(){return this.bookIndex<0||this.bookIndex>=bbooks.Books.length?"invalid":bbooks.Books[this.bookIndex].names[0]+" "+this.chapterAndVerse()},toShortUrl:function(){return this.bookIndex<0||this.bookIndex>=bbooks.Books.length?"invalid":(findvers.navigat,"/"+bbooks.Books[this.bookIndex].names[0].replace(" ","-")+"/"+this.chapter1+(this.verse1>-1?"/nav"+this.verse1:"")+"/ct")}}}};!function(){var e=1e5,n={},t=function(t,o){var l=new bible.Reference(t);href=l.bookIndex+1+","+l.chapter1+","+l.verse1+","+l.chapter2+","+l.verse2,function(t,o){var r="callback"+e++,l=i.createElement("script");s[r]=function(e){o(e)},n[t]=r,t+=(t.indexOf("?")>-1?"&":"?")+"callback="+r,l.setAttribute("src",t),l.setAttribute("type","text/javascript"),a.appendChild(l)}(r.remoteURL+"/jsonverse.php?ref="+encodeURIComponent(href),o)},o=function(e){if(e||(e=s.event),r.enablePopups){popclearPositionTimer();var n=e.target?e.target:e.srcElement,o=popp,i=n.getAttribute("rel"),a=n.getAttribute("ver");o.outer.style.display="block",o.outer.style.visibility="hidden",popdivShowTimer=setTimeout("popp.outer.style.visibility = 'visible';",300),o.header.innerHTML=i+a+n.getAttribute("context"),o.content.innerHTML="Loading...<br/><br/><br/>",poppositionPopup(n),t(i,(function(e){!function(e){popp.content.innerHTML="<div>"+e.content+"</div>"}(e),poppositionPopup(n)}))}},r={maxNodes:500,className:"findvers_reference",enablePopups:!0,navigat:!0,autoStart:!0,startNodeId:"",ignoreClassName:"findvers_ignore",ignoreTags:["h1","h2","h3","h4","noparse"],newTagName:"A",remoteURL:"",handleLinks:function(e,n){e.setAttribute("href","SIT"),e.setAttribute("context",'<span style="float:right;margin-right:-2px;"><a href="'+n.toShortUrl()+'" target="_blank" title="view context (new window)"><img src="/i/context.png" style="width:1.1em;border:0" /></a></span>'),e.setAttribute("rel",n.toString()),e.setAttribute("onclick","return false;"),e.setAttribute("ver",' <span style="font-weight:normal;font-size:80%;">(REV)</span>'),e.setAttribute("class",r.className),m(e,"mouseover",o),m(e,"mouseout",pophandleLinkMouseOut)}},s=window,i=document,a=null,l=bbooks.bbooks,c="(?:\\d{1,3}(?::\\d+)?)(?:ff|a|b)?(?:-\\d+((?::\\d+)?)(?:a)?)?",d=new RegExp("\\b(?:"+l+")\\.? (?:"+c+"(?:(?:, ?"+c+")|(?:(?:(?:;|,)? (?:and|or)|;) +(?:\\d{1,3}(?::\\d+))(?:ff|a|b)?(?:-\\d+((?::\\d+)?)(?:a)?)?))*)\\b","mi"),p=new RegExp(c,"mi"),u=["a","script","style","textarea"],b=null,f=function(e){var n,t,o=d.exec(e.data);return b=null,o?(n=o[0],(t=e.splitText(o.index)).splitText(n.length),h(e,t)):e},h=function(e,n){if(null==n.nodeValue)return n;var t,o,s,i,a,l=n.nodeValue.indexOf(","),c=n.nodeValue.indexOf(";"),d=n.nodeValue.indexOf(" and"),p=n.nodeValue.indexOf(", and"),u=n.nodeValue.indexOf("; and"),b=n.nodeValue.indexOf(" or"),f=n.nodeValue.indexOf(", or"),g=n.nodeValue.indexOf("; or");if(999==(t=Math.min(l<0?999:l,c<0?999:c,d<0?999:d,p<0?999:p,u<0?999:u,b<0?999:b,f<0?999:f,g<0?999:g))&&(t=-1),t>0){switch((o=n.splitText(t)).nodeValue.substring(0,3)){case"and":a=4;break;case" an":case", o":case"; o":a=5;break;case", a":case"; a":a=6;break;case" or":a=3;break;default:a=1}for(;a<o.nodeValue.length&&" "==o.nodeValue.substring(a,a+1);)a++;s=o.splitText(a)}return refText=n.nodeValue,void 0!==(i=v(refText))&&i.isValid()?(newNode=e.ownerDocument.createElement(r.newTagName),e.parentNode.replaceChild(newNode,n),r.handleLinks(newNode,i),newNode.appendChild(n),s&&(newNode=h(e,s)),newNode):n},v=function(e){var n,t,o,r,s,i,a,l=e,c=new bible.Reference(l),d=null,u=0;return null!=c&&void 0!==c.isValid&&c.isValid()?(b=c,c):null!=b?(d=p.exec(e))?(input=d[0],"ff"==input.slice(-2)&&(input=input.slice(0,-2),u=1),input=input.replace(/(\d)[a|b]/gi,"$1"),(i=b).chapter1,a=i.verse1,i.chapter2,i.verse2,params=bible.parseScriptureRef(input,b.bookIndex,u),t=params.c1,o=params.v1,r=params.c2,s=params.v2,b.chapter1=b.chapter1,b.verse1=-1,b.chapter2=-1,b.verse2=1==u?999:-1,n=s<0||1==u,a>0&&t>0&&o<0&&r<0&&n?b.verse1=t:t>0&&o<0&&r<0&&n?b.chapter1=t:t>0&&o>0&&r<0&&n?(b.chapter1=t,b.verse1=o):a>0&&t>0&&o<0&&r>0&&n?(b.verse1=t,b.verse2=1==u?999:r):t>0&&o<0&&r>0&&n?(b.chapter1=t,b.chapter2=r):t>0&&o>0&&r<0&&s>0?(b.chapter1=t,b.verse1=o,b.verse2=s):t>0&&o>0&&r>0&&s>0?(b.chapter1=t,b.verse1=o,b.chapter2=r,b.verse2=s):-99999,b):"javascript:null":void 0},g=function(e){k(e.childNodes[0],1,f)},k=function(e,n,t){for(var o=0,s=new RegExp("^("+u.concat(r.ignoreTags).join("|")+")$","i");e&&n>0;){if(++o>=r.maxNodes)return void setTimeout((function(){k(e,n,t)}),50);switch(e.nodeType){case 1:if(!s.test(e.tagName.toLowerCase())&&e.childNodes.length>0&&(""==r.ignoreClassName||-1==e.className.toString().indexOf(r.ignoreClassName))){e=e.childNodes[0],n++;continue}break;case 3:case 4:e=t(e)}if(e.nextSibling)e=e.nextSibling;else for(;n>0;)if(e=e.parentNode,n--,e.nextSibling){e=e.nextSibling;break}}},m=function(e,n,t){if(e.attachEvent)e.attachEvent("on"+n,t);else if(e.addEventListener)e.addEventListener(n,t,!1);else{var o=e["on"+n];e["on"+n]=function(){t(),o()}}},x=!1;scan=function(){x||(x=!0,i=document,a=i.body,""!=r.startNodeId&&(node=i.getElementById(r.startNodeId)),null==node&&(node=a),g(node),x=!1)},void 0!==window.findvers&&(r=function(){var e,n,t,o=arguments[0]||{},r=1,s=arguments.length;for("object"!=typeof o&&"function"!=typeof o&&(o={});r<s;r++)if(null!=(e=arguments[r]))for(n in e)o[n],o!==(t=e[n])&&void 0!==t&&(o[n]=t);return o}(r,window.findvers)),r.scan=scan,r.scanForReferences=g,s.findvers=r}();